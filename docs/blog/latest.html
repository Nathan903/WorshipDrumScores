<!DOCTYPE html>
<html>
<head>
	<meta name="viewport" content="width=device-width, initial-scale=1.0">

	<title>2.（最新报刊）分享链接</title>
</head>
<body>
	<p id=p>正在跳转至本周报刊...</p>
<script type="text/javascript">
	let diff = ["x",3,4,5,6,7,1,2];
	today = new Date();
	console.log(today);

	const lastFriday = today;
	lastFriday.setDate(today.getDate()-diff[today.getDay()]);
	
	function pr(i){
		if(i<10){
			return("0"+i)
		}
		return(""+i)
	}
	document.getElementsByTagName("body")[0]=1
	console.log(lastFriday);
	var b="https://praise.pages.dev/blog/"+lastFriday.getFullYear()+"/"+pr(lastFriday.getMonth()+1)+pr(lastFriday.getDate())
	console.log(b);


	var a = document.createElement('a');
    a.appendChild(document.createTextNode(b));
    a.href = b;
    document.body.appendChild(a);

    var request;
	if(window.XMLHttpRequest)
	{
	    request = new XMLHttpRequest();
	}
	else{
	    request = new ActiveXObject("Microsoft.XMLHTTP");
	}
	request.open('GET', b, false);
	request.send(); // there will be a 'pause' here until the response to come.
	// the object request will be actually modified
	console.log(1)
	if (request.status === 404) {
    	document.getElementById("p").innerHTML = "⚠️"+lastFriday.getFullYear()+"/"+(lastFriday.getMonth()+1)+"/"+pr(lastFriday.getDate())+"的报刊不存在";
	}
	else{
		window.location.href=b;
	}
	
</script>
</body>
</html>